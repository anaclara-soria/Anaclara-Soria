USE TINA_CAFE;
-- Ventas totales por periodo

CREATE VIEW tina_cafe.vw_ventas_por_periodo AS
SELECT
    SUM(p.precio * do.cantidades) AS ventas_totales,
    DATE(o.fecha) AS fecha
FROM orden as o
INNER JOIN detalle_orden as do 
ON o.id_orden = do.id_orden
INNER JOIN producto as p 
ON do.id_producto = p.id_producto
GROUP BY fecha
ORDER BY fecha DESC;

-- Ventas totales por producto

CREATE VIEW tina_cafe.vw_ventas_por_producto AS
SELECT 
    p.nombre AS producto,
    SUM(do.cantidades) AS unidades_vendidas,
    SUM(p.precio * do.cantidades) AS ventas_totales
FROM detalle_orden AS do
INNER JOIN producto AS p 
ON do.id_producto = p.id_producto
GROUP BY producto
ORDER BY ventas_totales DESC;

