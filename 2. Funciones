--FUNCION QUE DECLARE CANTIDAD DE PEDIDOS POR EMPLEADO (SIEMPRE Y CUANDO EXISTA ESE EMPLEADO)

use tina_cafe;

use tina_cafe;
set @nombre= '%Tomas%';

DROP FUNCTION IF EXISTS tina_cafe.fx_total_pedidos;
DELIMITER //
CREATE FUNCTION tina_cafe.fx_total_pedidos (_empleado VARCHAR (200)) -- parametros proveniente de la tabla empleado.
RETURNS INT -- tipo de dato que me retorna la funcion
READS SQL DATA

BEGIN
DECLARE resultado INT default 0;
select 
e.nombre,
count(o.id_orden) as total_pedidos into resultado
from orden as o
left join empleado as e
on o.id_empleado = e.id_empleado
where e.nombre like _empleado
group by e.id_empleado;

RETURN resultado;
END //
Delimiter ;






